<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<link rel="shortcut icon" href="/images/faviconnew.ico" />
<script type="text/javascript" src="https://vk.com/js/xd_connection.js" ></script>
<script type="text/javascript" src="//vk.com/js/api/openapi.js?97"></script>
<script src="http://img.creara-media.ru/js/v3/cmblockvk.js"></script>

<script type="text/javascript">

	var cmBlock;

	VK.init( function () {

		cmBlock = new CMBlockVK;

		cmBlock.setupPreroll( 23472, {} );

	});

</script>
<meta http-equiv="content-type" content="text/html; charset=windows-1251" />
<meta name="description" content="" />


<style>
body {
	background: #fff;
	color: #000;
	margin: 0px;
	padding: 0px;
	direction: ltr;
	font-family: "Helvetica Neue",Arial,Helvetica,sans-serif;
	font-size: 11px;
	font-weight: normal;
}

a {
  color: #2B587A;
  text-decoration: none;
  cursor: pointer;
}
a:hover {
  text-decoration: underline;
}

.fl_l {
	float: left;
}

.fl_r {
	float: right;
}

.hed {
	height: 65px;
	background: #6088bc;
}

.bublik_active {
	background: #fff;
	padding: 7px;
	font-size: 13px;
	color: #6088bc;
	border-radius: 4px;
	cursor: pointer;
	margin: 5px;
	font-weight: bold;
}

.bublik {
	color: #fff;
	font-size: 13px;
	padding: 7px;
	border-radius: 4px;
	cursor: pointer;
	margin: 5px;
	font-weight: bold;
}

.bublik:hover {
   background: #5a81b2;	
}

.bublick_padding {
	padding: 12px;
}

.many_buttom {
	background: #5084c2 url('img/bg_button.png');
	border: 1px solid #6a84de;
	padding: 10px;
	border-radius: 5px;
	color: #fff;
	font-weight: bold;
	font-size: 13px;
	cursor: pointer;
}

.money_i {
	padding: 10px;
	color: #f2f6fa;
	font-size: 13px;
	font-weight: bold;
	margin-right: 3px;
	-webkit-transition: all 0.20s ease-in-out;
	-moz-transition: all 0.20s ease-in-out;
	-o-transition: all 0.20s ease-in-out;
	transition: all 0.20s ease-in-out;
}



.money_i_red {
	padding: 10px;
	color: #6088bc;
	font-size: 13px;
	font-weight: bold;
	margin-right: 3px;
	background: #f6ff00;
	box-shadow: 0px 0px 15px 15px #f6ff00;
	-webkit-transition: all 0.20s ease-in-out;
	-moz-transition: all 0.20s ease-in-out;
	-o-transition: all 0.20s ease-in-out;
	transition: all 0.20s ease-in-out;
}


.money_ic {
	background: url('img/coin_icon.png');
	width: 16px;
	height: 17px;
	margin-left: 4px;
}

.many_bl {
	padding: 13px;
}

.user_img {
	width: 200px;
	height: 200px;
	background-size: 200px;
	border-radius: 5px;
}

.app_block {
	margin: 20px;
	height: 290px;
	border-bottom: 1px solid #dcdcdc;
}

.user_text {
	float: left;
	padding-left: 20px;
	width: 460px;
}

.user_title {
	font-size: 18px;
}

.user_textereal {
	padding-top: 8px;
}

.user_textereal textarea{
	border-top: 1px solid #bfbebe;
	border-right: 1px solid #bfbebe;
	border-left: 1px solid #bfbebe;
	border-bottom: 0px;
	padding: 5px;
	border-radius: 3px 3px 0px 0px;
	font-family: "Helvetica Neue",Arial,Helvetica,sans-serif;
	font-size: 13px;
	font-weight: normal;
	width: 445px;
	height: 40px;
	resize: none;
}

.textarea_button {
	width: 443px;
	padding: 7px;
	border-radius: 0px 0px 3px 3px;
	color: #fff;
	margin-bottom: 7px;
	background: #6994ca;
	text-align: center;
	font-size: 13px;
	font-weight: bold;
	cursor: pointer;
	text-shadow: 0px 1px 0px #5481b8;
}

.standart_kub {
	width: 125px;
	padding: 10px;
	color: #fff;
	text-align: center;
	background: #000;
	margin-top: 7px;
	border-bottom: 1px solid #fff;
	margin-right: 7px;
	float: left;
	border-radius: 3px;
	font-size: 15px;
	cursor: pointer;
	text-shadow: 0px 1px 0px rgba(0, 0, 0, 0.2);
}

.standart_kub:hover {
  border-top: 1px solid #f7f7f7;
  border-bottom: 0px;
}

.standart_kub:active {
  border-top: 1px solid #f7f7f7;
  border-bottom: 0px;
  font-size: 14px;
  padding-bottom: 11px;
}

.color1 {
   background: #54a54e;
}

.color2 {
   background: #6f57a1;
}

.color3 {
   background: #d3b259;
}

.color4 {
   background: #a45764;
}

.color5 {
   background: #8f8f8f;
}

.color6 {
   background: #647eea;
}

.color7 {
   background: #b231fd;
}

.color8 {
   background: #f0749c;
}

.color9 {
   background: #e87542;
}

.user_left {
  width: 200px;
  float: left;
}

.user_next {
	width: 150px;
	margin: 0px auto;
	padding-top: 10px;
	padding-bottom: 10px;
	border: 1px solid #d7d8d8;
	border-radius: 3px;
	text-align: center;
	font-size: 14px;
	background: url('img/next_bg.png');
	cursor: pointer;
}


.user_next:hover {
	box-shadow: inset 0px 0px 3px 0px rgba(0, 0, 0, 0.2);
}

.user_next:active {
	box-shadow: inset 0px 0px 10px 0px rgba(0, 0, 0, 0.2);
}

.piar_blus {
	background: #5e86b8;
	color: #fff;
	padding: 13px;
	float: left;
	font-size: 20px;
	border-radius: 3px;
	margin: 5px;
	cursor: pointer;
}

.piar_people {
	width: 50px;
	height: 50px;
	float: left;
	border-radius: 3px;
	margin: 5px;
}

.piar_text {
	color: #5e86b8;
	font-size: 15px;
	padding-left: 17px;
	margin-top: 7px;
}

.piar_block {
	height: 60px;
}

#load_page {
	background: #658fc4;
	width: 720px;
	height: 500px;
}

.load_msg {
	padding: 6px;
	border-radius: 3px;
	width: 200px;
	margin: 0px auto;
	background: #fff;
	text-align: center;
	color: #4f76aa;
	font-size: 13px;
	font-weight: bold;
}

#app_list {
	overflow: auto;
	height: 180px;
}

.list_ms {
	height: 50px;
	padding: 10px;
}

.list_ms:hover {
   cursor: pointer;
   background: #e7ecf2;
   border-radius: 3px;
}

.list_photo {
	width: 50px;
	height: 50px;
	border-radius: 3px;
	float: left;
}

.list_left {
	padding-left: 10px;
	width: 550px;
	float: left;
}

.list_uname {
	font-size: 14px;
	font-weight: bold;
	color: #406799;
}

.ms_buts {
	background: #6088bc;
	padding: 6px;
	color: #fff;
	font-size: 13px;
	font-weight: bold;
	border-radius: 3px;
	margin-top: 10px;
}

.list_anon {
	width: 420px;
	font-size: 13px;
	padding-left: 10px;
	overflow: hidden; 
	text-overflow: ellipsis; 
}

.sms_den {
	color: #567daf;
	text-align: center;
	padding-top: 50px;
	font-size: 20px;
	font-weight: bold;
}

#bg_box {
	padding-top: 40px;
	width: 720px;
	height: 500px;
	background: rgba(0, 0, 0, 0.6);
	position: absolute;
}

.body_box {
	background: #fff;
	border-radius: 7px;
	margin: 0px auto;
	box-shadow: 0px 0px 15px 0px rgba(0, 0, 0, 0.8);
}

.box_hide {
	text-align: center;
	padding: 10px;
	font-size: 12px;
	cursor: pointer;
	color: #2a2237;
}

.box_title {
	text-align: center;
	padding: 10px;
	font-size: 17px;
	color: #2a2237;
	font-weight: bold;
}

.box_many_select {
	background: #6088bc;
	margin: 10px;
	padding: 7px;
	border-radius: 3px;
	cursor: pointer;
	font-size: 15px;
	font-weight: bold;
	color: #fff;
	text-align: center;
}

.box_many {
	background: #fff;
	margin: 10px;
	padding: 7px;
	border-radius: 3px;
	cursor: pointer;
	font-size: 15px;
	font-weight: bold;
	color: #41496b;
	text-align: center;
}

.box_many:hover {
  background: #d7e4f4;
}

.profile_avatar {
	width: 50px;
	height: 50px;
	border-radius: 50%;
}

.profile_blos {
	height: 50px;
}

#profile_names, #profile_names_in {
	font-size: 20px;
	font-weight: bold;
}

#ms_sdivs_f_lst {
	height: 260px;
	overflow: auto;
}
</style>
</head>

<body>
	<div id="bg_box" style="display: none;" >
		<div class="body_box" style="width: 200px;margin: 0px auto;display: none;" id="box_load" >
			<div class="box_title" >Загрузка...</div>
		</div>
		<div class="body_box" style="width: 300px;margin: 0px auto;height: 216px;display: none;" id="box_group" >
			<div class="box_title" >Бонус!</div>
			<div style="width: 200px;margin: 0px auto;" >
			<div style="height: 108px;background: #fff;position: absolute;width: 200px;text-align: center;font-size: 12px;" >
				<div style="padding-top: 20px;" >Подпишись на сообщество и получи бонус в размере
				<div>
					<b>500 монет!</b>
				</div>
			</div>
			</div>
			 <div id="vk_groups"></div>
		    </div>
			<div class="box_hide" onclick="box_hide('group');" >Закрыть</div>
          <script type="text/javascript">
           VK.Widgets.Group("vk_groups", {mode: 1, width: "200", height: "200", color1: 'FFFFFF', color2: '6088bc', color3: '6088bc'}, 56193663);
          </script>
		</div>
		<div class="body_box" style="width: 300px;display: none;" id="box_piar" >
			<div class="box_title" >Стать популярным</div>
         <div style="padding: 10px;text-align: center;" >

          Это будет стоить 1000 монет

         </div>

        	<div class="many_buttom" style="width: 200px;margin: 0px auto;text-align: center;" onclick="add_piar();" id="title_bupiar" >
   		Пропиарится!
   	</div>
			<div class="box_hide" onclick="box_hide('piar');" >Закрыть</div>
		</div>
     <div class="body_box" style="width: 320px;display: none;" id="box_many" >
       <div class="box_title" >Купить монетки</div>
        <div style="padding: 10px;text-align: center;" >Сколько монет будете покупать?</div>
        <div class="box_many" id="boxmon1" onclick="select_money(1);" >
        1 голос = 1000 монет <div class="money_ic fl_r" ></div>
        </div>


        <div class="box_many_select" id="boxmon2" onclick="select_money(2);" >
         2 голоса = 4000 монет <div class="money_ic fl_r" ></div>
        </div>

        <div class="box_many" id="boxmon3" onclick="select_money(3);" >
          5 голосов = 10 000 монет <div class="money_ic fl_r" ></div>
        </div>

        <div class="box_many" id="boxmon4" onclick="select_money(4);" >
          10 голосов = 15 000 монет <div class="money_ic fl_r" ></div>
        </div>
 
        	<div class="many_buttom" style="width: 200px;margin: 0px auto;text-align: center;" onclick="order();" >
   		Купить монетки
   	</div>

       <div class="box_hide" onclick="box_hide('many');" >Закрыть</div>
     </div>

	</div>


	<div id="load_page" >
		<div style="padding: 210px;" >
		<div class="load_msg" >Приложения загружается...</div>
	</div>
	</div>
	<div id="page" style="display: none;" >
 <div class="hed" >
 	<div class="bublick_padding fl_l" >
	<div class="bublik_active fl_l" onclick="argub(1);" id="bublk_id1" >Отправить мнения</div>
	<div class="bublik fl_l" onclick="argub(2);" id="bublk_id2" ><span style="float: left;" >Мнения</span> <span id="total_mn" style="display: none;float: left;padding-left: 5px;" >+0</span></div>
	<div class="bublik fl_l" onclick="argub(3);" id="bublk_id3" >Друзья</div>
</div>
   <div class="many_bl fl_r" >
   	<div class="money_i fl_l" id="balance" >
   		<div class="fl_l" >Баланс: <span id="total_coin" >0</span></div>
   		<div class="money_ic fl_l" ></div>
   	</div>
   	
   	<div class="many_buttom fl_l" onclick="show_box('many');" >
   		<div class="fl_l" >Пополнить +</div>
   		<div class="money_ic fl_l" ></div>
   	</div>
   </div>
</div>
<div class="app_block" id="ms_sdivs" style="display: none;" >
	<div class="profile_blos" >
   <a href="http://vk.com/id<?=(int) $_GET['viewer_id']?>" target="_blank" ><div style="float: left;" class="profile_avatar" id="profile_avatar" ></div></a>
   <div id="profile_names" style="float: left;padding-left: 10px;padding-top: 11px;color: #5078c4;" ></div>
   
</div>
	<div class="user_title" style="padding-top: 10px;padding-bottom: 10px;color: #5078c4;" >Мнения o <span id="profile_name" ></span>:</div>
<div id="app_list" >
<div class="list_ms" >
	<div class="list_photo" style="background-image: url('https://pp.vk.me/c417217/v417217969/7c0d/D2tYv6ntHAk.jpg');" ></div>
	<div class="list_left" >
    <div class="list_uname" >Anton Rumnov</div>
   аыва
   </div>
</div>


<div class="list_ms" >
	<div class="list_anon fl_l" >1234</div>
	<div class="ms_buts fl_r" >
        <div class="fl_l" >Раскрыть за 500</div>
   		<div class="money_ic fl_l" ></div>
	</div>
</div>


</div></div>


<div class="app_block" id="ms_sdivs_in" style="display: none;" >
	<div class="profile_blos" >
   <a id="p_in" target="_blank" ><div style="float: left;" class="profile_avatar" id="profile_avatar_in" ></div></a>
   <div id="profile_names_in" style="float: left;padding-left: 10px;padding-top: 11px;color: #5078c4;" ></div>
   <div class="fl_r" id="but_ins" ></div>
</div>
	<div class="user_title" style="padding-top: 10px;padding-bottom: 10px;color: #5078c4;" >Мнения o <span id="profile_name_in" ></span>:</div>
<div id="app_list_in" >
<div class="list_ms" >
	<div class="list_photo" style="background-image: url('https://pp.vk.me/c417217/v417217969/7c0d/D2tYv6ntHAk.jpg');" ></div>
	<div class="list_left" >
    <div class="list_uname" >Anton Rumnov</div>
   1234
   </div>
</div>


<div class="list_ms" >
	<div class="list_anon fl_l" >1234</div>
	<div class="ms_buts fl_r" >
        <div class="fl_l" >Раскрыть за 500</div>
   		<div class="money_ic fl_l" ></div>
	</div>
</div>


</div></div>

<div class="app_block" id="ms_sdivs_f" style="display: none;" >
	<div id="ms_sdivs_f_lst" onscroll="scroll_firend();" >
	</div>
</div>

<div class="app_block" id="ms_sdiv">
	<div class="user_left" >
<a onclick="show_profile();" ><div class="user_img" id="user_img" style="background-image: url('https://pp.vk.me/c319624/v319624441/94de/UTocmG2jkDA.jpg');" ></div></a>
<div style="padding-top: 17px;" >
<div class="user_next" onclick="next_user();" >Пропустить »</div>
</div>
</div>
<div class="user_text" >
 <div class="user_title" style="color: #5078c4;" >Ваше мнения о <a onclick="show_profile();" ><span id="user_tname" >Антоне</span></a>:</div>
 <div class="user_textereal" >
 	<textarea placeholder="Мнения..." id="user_textarea" ></textarea>
 	<input type="hidden" id="user_id" >
 	<input type="hidden" id="user_hash" >
 	<input type="hidden" id="user_key" value="<?=preg_replace('/[^a-zA-ZА-Яа-я0-9\s]/', '', $_GET['auth_key'])?>" >
 </div>
 <div class="textarea_button" onclick="send_mn(0);" >Отправить мнения</div>
 <div>
 <div class="user_title" >Стандартные мнения:</div>
 <div class="standart_m" >
 	<div id="mn_sex1" style="display: none;" >
 	 <div class="standart_kub color1" onclick="send_mn(1);" >Крутой</div>
 	 <div class="standart_kub color2" onclick="send_mn(2);" >Дружный</div>
 	 <div class="standart_kub color3" onclick="send_mn(3);" >Веселый</div>
 	 <div class="standart_kub color4" onclick="send_mn(4);" >Злой</div>
 	 <div class="standart_kub color5" onclick="send_mn(5);" >Идиот</div>
 	 <div class="standart_kub color6" onclick="send_mn(6);" >Хитрый</div>
 	 <div class="standart_kub color7" onclick="send_mn(7);" >Умный</div>
 	 <div class="standart_kub color8" onclick="send_mn(8);" >Добрый</div>
 	 <div class="standart_kub color9" onclick="send_mn(9);" >Понимающий</div>
 	</div>
 <div id="mn_sex2" style="display: none;" >
 <div class="standart_kub color1" onclick="send_mn(1);" >Крутая</div>
 	 <div class="standart_kub color2" onclick="send_mn(2);" >Дружная</div>
 	 <div class="standart_kub color3" onclick="send_mn(3);" >Веселая</div>
 	 <div class="standart_kub color4" onclick="send_mn(4);" >Злая</div>
 	 <div class="standart_kub color5" onclick="send_mn(5);" >Идиотка</div>
 	 <div class="standart_kub color6" onclick="send_mn(6);" >Хитрая</div>
 	 <div class="standart_kub color7" onclick="send_mn(7);" >Умная</div>
 	 <div class="standart_kub color8" onclick="send_mn(8);" >Добрая</div>
 	 <div class="standart_kub color9" onclick="send_mn(9);" >Понимающая</div>
 </div>
 	</div>
 </div>
</div>
</div>
<div class="piar_block" >
	<div class="piar_blus" onclick="show_box('piar');" >+</div>
	<div id="uslist" style="float: left;" >
	<a href="" ><div class="piar_people" style="background-image: url('https://pp.vk.me/c417217/v417217969/7c0d/D2tYv6ntHAk.jpg');" ></div></a>
	<a href="" ><div class="piar_people" style="background-image: url('https://pp.vk.me/c417217/v417217969/7c0d/D2tYv6ntHAk.jpg');" ></div></a>
	<a href="" ><div class="piar_people" style="background-image: url('https://pp.vk.me/c417217/v417217969/7c0d/D2tYv6ntHAk.jpg');" ></div></a>
	<a href="" ><div class="piar_people" style="background-image: url('https://pp.vk.me/c417217/v417217969/7c0d/D2tYv6ntHAk.jpg');" ></div></a>
	<a href="" ><div class="piar_people" style="background-image: url('https://pp.vk.me/c417217/v417217969/7c0d/D2tYv6ntHAk.jpg');" ></div></a>
	<a href="" ><div class="piar_people" style="background-image: url('https://pp.vk.me/c417217/v417217969/7c0d/D2tYv6ntHAk.jpg');" ></div></a>
	<a href="" ><div class="piar_people" style="background-image: url('https://pp.vk.me/c417217/v417217969/7c0d/D2tYv6ntHAk.jpg');" ></div></a>
	<a href="" ><div class="piar_people" style="background-image: url('https://pp.vk.me/c417217/v417217969/7c0d/D2tYv6ntHAk.jpg');" ></div></a>
	<a href="" ><div class="piar_people" style="background-image: url('https://pp.vk.me/c417217/v417217969/7c0d/D2tYv6ntHAk.jpg');" ></div></a>
	<a href="" ><div class="piar_people" style="background-image: url('https://pp.vk.me/c417217/v417217969/7c0d/D2tYv6ntHAk.jpg');" ></div></a>
	<a href="" ><div class="piar_people" style="background-image: url('https://pp.vk.me/c417217/v417217969/7c0d/D2tYv6ntHAk.jpg');" ></div></a>
</div>
</div>
<div class="piar_text" >
	<img src="img/piar_icon.png" >
	<b>Нажимай!</b> если хочешь пропиариться
	</div> 
</div>
<div id="audio_mp3" style="display: none;" ></div>
	</body>

<script type="text/javascript">
mes_status = 0, active_money = 2, total_astss = 0, mllisud = '';

VK.addCallback('onRequestSuccess', ok_not); 
VK.addCallback('onRequestCancel', none_not); 
VK.addCallback('onRequestFail', none_not); 
VK.addCallback('onOrderSuccess', ok_pay); 
VK.addCallback('onSettingsChanged', ok_set); 

function select_money (id) {
	if(active_money != id){
		ge('boxmon' + active_money).className = 'box_many';
		ge('boxmon' + id).className = 'box_many_select';
		active_money = id;
	}
}
function argub(id) {
   hide('ms_sdivs_in');
   if(id == 1){
    show('ms_sdiv');
    hide('ms_sdivs');
    hide('ms_sdivs_f');
    ge('bublk_id1').className = 'bublik_active fl_l';
    ge('bublk_id2').className = 'bublik fl_l';
    ge('bublk_id3').className = 'bublik fl_l';
   }else if(id == 3){
    hide('ms_sdiv');
    hide('ms_sdivs');
    show('ms_sdivs_f');
    ge('bublk_id1').className = 'bublik fl_l';
    ge('bublk_id2').className = 'bublik fl_l';
    ge('bublk_id3').className = 'bublik_active fl_l';
   }else{
    show('ms_sdivs');
    hide('ms_sdiv');
    hide('ms_sdivs_f');
    ge('bublk_id2').className = 'bublik_active fl_l';
    ge('bublk_id1').className = 'bublik fl_l';
    ge('bublk_id3').className = 'bublik fl_l';
    if(ge('total_mn').innerHTML != '0'){ 
     ajax.post('reg.php', {uid: <?=(int) $_GET['viewer_id']?>, ukey: '<?=preg_replace('/[^a-zA-ZА-Яа-я0-9\s]/', '', $_GET['auth_key'])?>', act: 'snull'}, function (res) {
     	var res = JSON.parse(res);
     	if(res.error == 1){
     		// alert('error');
     		location.href = location.href;
     	}else{
    	 hide('total_mn'); 
    	 ge('total_mn').innerHTML = '+0';
        }
     });
    }
   }
}

function order() {
    var params = {
      type: 'item',
      item: 'type' + active_money
    };
    VK.callMethod('showOrderBox', params);
  }

function ok_pay (argument) {
	box_hide('many');
	ajax.post('reg.php', {act: 'balanse', uid: <?=(int) $_GET['viewer_id']?>, ukey: '<?=preg_replace('/[^a-zA-ZА-Яа-я0-9\s]/', '', $_GET['auth_key'])?>'}, function (res) {
	 if(res == 'no'){
	 	// alert('error');
	 	location.href = location.href;
	 }
	 var res = JSON.parse(res);
	 ge('total_coin').innerHTML = res.many;
	 var audio_html = '<audio autoplay=\"autoplay\"><source src=\"many.mp3\" type=\"audio\/mpeg\"><source src=\"many.ogg\" type=\"audio\/ogg\"><\/audio>';
	 ge('audio_mp3').innerHTML = audio_html;
	 ge('balance').className = 'money_i_red fl_l';
	 setTimeout(function() { ge('balance').className = 'money_i fl_l'; }, 100);
	});
}

function add_piar(t) {
	ge('title_bupiar').innerHTML = 'Загрузка...';
	ajax.post('reg.php', {act: 'add_piar', id: <?=(int) $_GET['viewer_id']?>, key: '<?=preg_replace('/[^a-zA-ZА-Яа-я0-9\s]/', '', $_GET['auth_key'])?>', photo: us[0].photo}, function (res) {
		ge('title_bupiar').innerHTML = 'Пропиарится!';
		if(res == 'no'){
			alert('error');
			location.href = location.href;
		}else{
		  var data = JSON.parse(res);
		  var uslist_html = '';
		  if(data.error == 1) {
		  	alert('У вас не хватает монеток');
		  	hide('box_piar');
		  	show('box_many');
		  }else{
		  	box_hide('piar');
		   for (var i = 0; i < data.piar_list.length; i++) {
		    uslist_html += '<a href=\"http://vk.com/id' + data.piar_list[i].id + '\" target=\"_blank\" ><div class=\"piar_people\" style=\"background-image: url(\'' + data.piar_list[i].photo + '\');\" ><\/div><\/a>';
		   }
		   ge('uslist').innerHTML = uslist_html;
		   var audio_html = '<audio autoplay=\"autoplay\"><source src=\"many.mp3\" type=\"audio\/mpeg\"><source src=\"many.ogg\" type=\"audio\/ogg\"><\/audio>';
		   ge('audio_mp3').innerHTML = audio_html;
		   ge('balance').className = 'money_i_red fl_l';
		   setTimeout(function() { ge('balance').className = 'money_i fl_l'; }, 100);
		   ge('total_coin').innerHTML = data.money;
		  }
		}
	});
}

function ok_set (argument) {
	// body...
}

function ge(el) {
        return (typeof el == 'string' || typeof el == 'number') ? document.getElementById(el) : el;
}

function show(elem) {
  ge(elem).style.display = 'block';
}

function hide(elem) {
  ge(elem).style.display = 'none';
}


function doOpa(ts){
  ge('bg_box').style.opacity = '0.' + ts;
  ts += 2;
  if (10 > ts){
    setTimeout(function () {
    	doOpa(ts);
    }, 5);
  }else{
  	setTimeout(function () {
  	 ge('bg_box').style.opacity = 1;
  	}, 5);
  }
}

function noOpa(t, cal){
  ge('bg_box').style.opacity = '0.' + t;
  t -= 2;
  if (t > 0){
    setTimeout(function () {
    	noOpa(t, cal);
    }, 5);
  }else{
  	setTimeout(function () {
  	 ge('bg_box').style.opacity = 0;
  	 cal();
  	}, 5);
  }
}

function show_box (div, s) {
	 ge('bg_box').style.opacity = 0.0;
	 show('bg_box');
	 show('box_' + div);
	 doOpa(0);
}

function box_hide (div, s) {
	 noOpa(10, function () {
		hide('bg_box');
	    hide('box_' + div);
	 });
}


function getXmlHttp(){
  var xmlhttp;
  try {
    xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");
  } catch (e) {
    try {
      xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    } catch (E) {
      xmlhttp = false;
    }
  }
  if (!xmlhttp && typeof XMLHttpRequest!='undefined') {
    xmlhttp = new XMLHttpRequest();
  }
  return xmlhttp;
}


function rand(min, max){
  return Math.floor(Math.random() * (max - min + 1)) + min;
}


var ajax = {
  post: function (page, param, cal) {  
   var req = getXmlHttp();
   req.onreadystatechange = function() {  
   if (req.readyState == 4) { 
     if(req.status == 200) { 
      if(cal){
        cal(req.responseText);
       }
      }else{
        //alert('false load page (' + page + '), status (' + req.status + ')');
      }
     }
    }
   req.open('POST', page, true);  
   req.setRequestHeader('Content-type','application/x-www-form-urlencoded');
   req.send(ajax.parse(param));  
  },
  parse: function (par) {
   var post_param = '';
   for (var key in par) {
     post_param += key + '=' + encodeURIComponent(par[key]) + '&';
   }
   return post_param;
  }
}

function show_profile () {
	show_box('load');
	for (var i = 0; i < total_friend-1; i++) {
      if(friends[i].id == acs_user){
      	posy = i;
      }
	}
	VK.api('users.get', {user_ids: acs_user, v: 5, fields: "photo,sex", https: "1"}, function(res) {
		ajax.post('reg.php', {act: 'show_us', id:  <?=(int) $_GET['viewer_id']?>, key: '<?=preg_replace('/[^a-zA-ZА-Яа-я0-9\s]/', '', $_GET['auth_key'])?>', oid: res.response[0].id}, function (resm) {
			var uslist_html_in = '', mllist_html_in = '';
			var data = JSON.parse(resm);
			ge('uslist').innerHTML = uslist_html;
			if(res.response.user[0].sex == 1){
			 var sex_array = ['ая', 'ая', 'ая', 'ая', 'ка', 'ая', 'ая', 'ая', 'ая'];
			}else{
			 var sex_array = ['ой', 'ый', 'ый', 'ой', '', 'ый', 'ый', 'ый', 'ий'];
			}
            if(data.ml_list){
             for (var i = 0; i < data.ml_list.length; i++) {  	
              if(data.ml_list[i].mid == 0){
               var im_msg_in = data.ml_list[i].msg;
              }else{
               var im_msg_in = data.ml_list[i].msg + sex_array[data.ml_list[i].mid];
              }
              if(data.ml_list[i].user == 0){
               mllist_html_in += '<div id=\"lsot_id' + data.ml_list[i].oid + '\" ><div class=\"list_ms\" ><div class=\"list_photo\" style=\"background-image: url(\'img/nophoto.png\');\" ><\/div><div class=\"list_anon fl_l\" ><div class=\"list_uname\" >Аноним<\/div>' + im_msg_in + '<\/div><div class=\"ms_buts fl_r\" onclick=\"open_sil(\'' + data.ml_list[i].hash + '\', ' + data.ml_list[i].oid + ');\" ><div class=\"fl_l\" >Раскрыть за 200<\/div><div class=\"money_ic fl_l\" ><\/div><\/div><\/div><\/div>';
              }else{
               mllisud_in+= data.ml_list[i].user + ',';
               mllist_html_in += '<a href=\"http://vk.com/id' + data.ml_list[i].user + '\" target=\"_blank\" ><div class=\"list_ms\" ><div class=\"list_photo\" id=\"mllist_photo' + data.ml_list[i].user + '_s' + total_astss_in + '\" style=\"background-image: url(\'img/nophoto.png\');\" ><\/div><div class=\"list_anon fl_l\" ><div class=\"list_uname\" id=\"mllist_name' + data.ml_list[i].user + '_s' + total_astss_in + '\" >Загрузка...<\/div>' + im_msg_in + '<\/div><\/div><\/a>';
               total_astss_in+=1;
              }
             }
            }else{
            	// alert('Ошибка');
            	location.href = location.href;
            }

		});

	 ge('but_ins').innerHTML = '<div class=\"many_buttom\" onclick=\"send_friend(' + posy + ');argub(1);\" >Оставить мнение<\/div>';
	 ge('p_in').href = 'http://vk.com/id' + res.response[0].id;
     ge('profile_name_in').innerHTML = res.response[0].first_name;
     ge('profile_names_in').innerHTML = res.response[0].first_name;
     ge('profile_avatar_in').style.backgroundImage = 'url(\'' + res.response[0].photo + '\')';
     hide('ms_sdiv');
     hide('ms_sdivs');
	 show('ms_sdivs_in');
	 box_hide('load');
    });
}



function send_friend(numer) {
	if(!friends[numer]){
		// alert('error');
		location.href = location.href;
	}
	if(friends[numer] == undefined){
		// alert('error');
		location.href = location.href;
	}
	if(friends[numer] == null){
		// alert('error');
		location.href = location.href;
	}
	acs_user = friends[numer].id;
	ge('user_img').style.backgroundImage = 'url(\'' + friends[numer].photo_big + '\')';
	ge('user_tname').innerHTML = friends[numer].first_name;
	ge('user_textarea').value = null;
	ge('user_id').value = friends[numer].id;
	if(friends[numer].sex == 1){
        show('mn_sex2');
		hide('mn_sex1');
	}else{
		show('mn_sex1');
		hide('mn_sex2');
	}
	active_user = numer;
	ge('user_textarea').focus();
}

function next_user() {
   active_user++;
   if(friends[active_user]){
    send_friend(active_user);
   }else{
    active_user = 0;
    send_friend(active_user);
   }
}

function none_not () {
	mes_status = 0;
	next_user()
}


function ok_not () {
	next_user()
	if(rand(1, 10) == 3) { mes_status = 0; }
}

function send_mn(id) {
if(id == 0 && ge('user_textarea').value == '') { 
	alert('Заполните поле!'); 
}else{
	ajax.post('reg.php', {act: 'send_mn', type: id, mid: <?=(int) $_GET['viewer_id']?>, user_id: ge('user_id').value, user_hash: ge('user_hash').value, user_key: ge('user_key').value, msg: ge('user_textarea').value}, function (ames) {
	 var mes = JSON.parse(ames);
	 if(mes.hash){
	  ge('total_coin').innerHTML = mes.money;
	  ge('user_hash').value = mes.hash;
	  var audio_html = '<audio autoplay=\"autoplay\"><source src=\"many.mp3\" type=\"audio\/mpeg\"><source src=\"many.ogg\" type=\"audio\/ogg\"><\/audio>';
	  ge('audio_mp3').innerHTML = audio_html;
	  ge('balance').className = 'money_i_red fl_l';
	  setTimeout(function() { ge('balance').className = 'money_i fl_l'; }, 100);
	 }else{
	  error_app(mes.error);
	 }
	 if(mes_status == 0) { 
	 	send_post(ge('user_id').value);
	  }else{
	   send_notif(ge('user_id').value); 
	  }
	});
}
}

function send_post (uid) {
	VK.api('wall.post', {owner_id: uid, message: 'Я написал свое мнения о тебе \n Зайди и помотри • vk.com/app3804278', attachments: 'photo214238969_308261613', https: 1}, function (res) {
		next_user();
		if(!res.response) mes_status = 1;
	});
}


function send_notif (uid) {
	VK.callMethod('showRequestBox', uid, 'О тебе оставили мнение! \n Зайди и помотри • vk.com/app3804278');
}

function open_sil (hash, id) {
	ajax.post('reg.php', {hash: hash, id: id, act: 'ras', mid: <?=(int) $_GET['viewer_id']?>, ukey: '<?=preg_replace('/[^a-zA-ZА-Яа-я0-9\s]/', '', $_GET['auth_key'])?>'}, function (res) {
		var data = JSON.parse(res);
		if(data.error == 1){
			// alert('error');
			location.href = location.href;
		}else if(data.error == 2){
            alert('У вас не хватает монеток');
		  	show_box('many');
		}else{
		 ge('total_coin').innerHTML = data.many;
		 ok_imser(data.info.id, data.info.uid, data.info.msg, data.info.mid);
		 var audio_html = '<audio autoplay=\"autoplay\"><source src=\"many.mp3\" type=\"audio\/mpeg\"><source src=\"many.ogg\" type=\"audio\/ogg\"><\/audio>';
	  ge('audio_mp3').innerHTML = audio_html;
	  ge('balance').className = 'money_i_red fl_l';
	  setTimeout(function() { ge('balance').className = 'money_i fl_l'; }, 100);
	    }
	});
}

function error_app(msg) {
	ajax.post('reg.php', {act: 'debugs', msg: msg, mid: '<?=(int) $_GET['viewer_id']?>', hk: '<?=preg_replace('/[^a-zA-ZА-Яа-я0-9\s]/', '', $_GET['auth_key'])?>'}, function (mes) {
		if(mes == 'ok'){
		 // alert('Ошибка! Обновите страницу.');
		 location.href = location.href;
	    }else{
		 // alert('Сегодня не ваш день -_-, попробуйте опять зайти');
		 location.href = location.href;
	    }
	});
}


function scroll_firend () {
 var scrollTop = ge('ms_sdivs_f_lst').pageYOffset || ge('ms_sdivs_f_lst').scrollTop || ge('ms_sdivs_f_lst').scrollTop;
 var height_div = Math.abs(270 - ge('ms_sdivs_f_lst').scrollHeight);
 if(scrollTop > height_div){
  for (var s = scrols_fr; s < scrols_fr+4; s++){
   if(friends[s]) ge('ms_sdivs_f_lst').innerHTML+= '<a onclick=\"send_friend(\'' + s + '\');argub(1);\" target=\"_blank\" ><div class=\"list_ms\" ><div class=\"list_photo\" style=\"background-image: url(\'' + friends[s].photo + '\');\" ><\/div><div class=\"list_anon fl_l\" ><div class=\"list_uname\" >' + friends[s].first_name + ' ' + friends[s].last_name + '<\/div><\/div><\/div><\/a>';
  }
  scrols_fr+=4;
 }
}

VK.api('execute', {https: 1, code: 'return {"user_name": API.users.get()@.first_name, "user": API.users.get({"fields": "sex,photo_big,photo", "name_case": "abl"}), "friends": API.friends.get({"fields": "sex,photo_big,photo", "name_case": "abl"})};', v: 5}, function(res) {
 if(res.error) { /* alert('error vk api'); */  location.href = location.href; }
 friends = res.response.friends.items;
 us = res.response.user;
 total_friend = res.response.friends.count;
 for (var s = 0; s < 4; s++){
 	if(friends[s]) ge('ms_sdivs_f_lst').innerHTML+= '<a onclick=\"send_friend(\'' + s + '\');argub(1);\" target=\"_blank\" ><div class=\"list_ms\" ><div class=\"list_photo\" style=\"background-image: url(\'' + friends[s].photo + '\');\" ><\/div><div class=\"list_anon fl_l\" ><div class=\"list_uname\" >' + friends[s].first_name + ' ' + friends[s].last_name + '<\/div><\/div><\/div><\/a>';
 }
 scrols_fr = 4;
 ge('profile_name').innerHTML = us[0].first_name;
 ge('profile_names').innerHTML = res.response.user_name[0];
 ge('profile_avatar').style.backgroundImage = 'url(\'' + us[0].photo + '\')';
 ajax.post('reg.php', {id: <?=(int) $_GET['viewer_id']?>, act: 'reg', key: '<?=preg_replace('/[^a-zA-ZА-Яа-я0-9\s]/', '', $_GET['auth_key'])?>'}, function(data) {
   if(!friends){
   	// alert('error');
   	location.href = location.href;
   }
   var data = JSON.parse(data);
   if(data.error) error_app(data.error);
   ge('total_coin').innerHTML = data.money;
   if(data.total != 0){ show('total_mn'); ge('total_mn').innerHTML = '+' + data.total; } 
   ge('user_hash').value = data.hash;
   var uslist_html = '', mllist_html = '';
   for (var i = 0; i < data.piar_list.length; i++) {
    uslist_html += '<a href=\"http://vk.com/id' + data.piar_list[i].id + '\" target=\"_blank\" ><div class=\"piar_people\" style=\"background-image: url(\'' + data.piar_list[i].photo + '\');\" ><\/div><\/a>';
   }
   ge('uslist').innerHTML = uslist_html;
   if(res.response.user[0].sex == 1){
    var sex_array = ['ая', 'ая', 'ая', 'ая', 'ка', 'ая', 'ая', 'ая', 'ая'];
   }else{
    var sex_array = ['ой', 'ый', 'ый', 'ой', '', 'ый', 'ый', 'ый', 'ий'];
   }


   if(data.ml_list){
    for (var i = 0; i < data.ml_list.length; i++) {  	
   	 if(data.ml_list[i].mid == 0){
   		var im_msg = data.ml_list[i].msg;
   	 }else{
   		var im_msg = data.ml_list[i].msg + sex_array[data.ml_list[i].mid];
   	 }

   	 if(data.ml_list[i].user == 0){
      mllist_html += '<div id=\"lsot_id' + data.ml_list[i].oid + '\" ><div class=\"list_ms\" ><div class=\"list_photo\" style=\"background-image: url(\'img/nophoto.png\');\" ><\/div><div class=\"list_anon fl_l\" ><div class=\"list_uname\" >Аноним<\/div>' + im_msg + '<\/div><div class=\"ms_buts fl_r\" onclick=\"open_sil(\'' + data.ml_list[i].hash + '\', ' + data.ml_list[i].oid + ');\" ><div class=\"fl_l\" >Раскрыть за 200<\/div><div class=\"money_ic fl_l\" ><\/div><\/div><\/div><\/div>';
   	 }else{
   	  mllisud+= data.ml_list[i].user + ',';
   	  mllist_html += '<a href=\"http://vk.com/id' + data.ml_list[i].user + '\" target=\"_blank\" ><div class=\"list_ms\" ><div class=\"list_photo\" id=\"mllist_photo' + data.ml_list[i].user + '_s' + total_astss + '\" style=\"background-image: url(\'img/nophoto.png\');\" ><\/div><div class=\"list_anon fl_l\" ><div class=\"list_uname\" id=\"mllist_name' + data.ml_list[i].user + '_s' + total_astss + '\" >Загрузка...<\/div>' + im_msg + '<\/div><\/div><\/a>';
      total_astss+=1;
   	 }
  
    }
   }else{
     mllist_html = '<div class=\"sms_den\" >Нету мнения о вас<br><a onclick=\"VK.callMethod(\'showInviteBox\');\" >Пригласить друзей!<\/a><\/div>';
   }
   ge('app_list').innerHTML = mllist_html;
   send_friend(rand(0, total_friend - 1));
   joinGroup();
   if(mllisud != ''){
    VK.api('users.get', {user_ids: mllisud, v: 5, fields: "photo", https: "1"}, function (users) {
   	 for (var i = 0; i < users.response.length; i++){
   	 	for (var n = 0; n < total_astss; n++){
   	 	 if(ge('mllist_name' + users.response[i].id + '_s' + n)){
   		  ge('mllist_name' + users.response[i].id + '_s' + n).innerHTML = users.response[i].first_name + ' ' + users.response[i].last_name;
   		  ge('mllist_photo' + users.response[i].id + '_s' + n).style.backgroundImage = 'url(\'' + users.response[i].photo + '\')';
   		 }
   	 	}
   		show('page');
        hide('load_page');
   	 }
    });
   }else{
   	show('page');
    hide('load_page');
   }   
 });
});


function ok_imser (id, uid, msg, mid) {
	if(us[0].sex == 1){
    var sex_array = ['ая', 'ая', 'ая', 'ая', 'ка', 'ая', 'ая', 'ая', 'ая'];
   }else{
    var sex_array = ['ой', 'ый', 'ый', 'ой', '', 'ый', 'ый', 'ый', 'ий'];
   }
   if(mid == 0){
   		var im_msg = msg;
   	 }else{
   		var im_msg = msg + sex_array[mid];
   	 }
	ge('lsot_id' + id).innerHTML = '<a href=\"http://vk.com/id' + uid + '\" target=\"_blank\" ><div class=\"list_ms\" ><div class=\"list_photo\" id=\"mllist_photo' + uid + '_s' + total_astss + '\" style=\"background-image: url(\'img/nophoto.png\');\" ><\/div><div class=\"list_anon fl_l\" ><div class=\"list_uname\" id=\"mllist_name' + uid + '_s' + total_astss + '\" >Загрузка...<\/div>' + im_msg + '<\/div><\/div><\/a>';
    total_astss+=1;
    VK.api('users.get', {user_ids: uid, v: 5, fields: "photo", https: "1"}, function (users) {
   	 for (var i = 0; i < users.response.length; i++){
   	 	for (var n = 0; n < total_astss; n++){
   	 	 if(ge('mllist_name' + users.response[i].id + '_s' + n)){
   		  ge('mllist_name' + users.response[i].id + '_s' + n).innerHTML = users.response[i].first_name + ' ' + users.response[i].last_name;
   		  ge('mllist_photo' + users.response[i].id + '_s' + n).style.backgroundImage = 'url(\'' + users.response[i].photo + '\')';
   		 }
   	 	}
   		show('page');
        hide('load_page');
   	 }
    });
}

setTimeout(function() {
  if(ge('page').style.display != 'block' && ge('load_page').style.display != 'none'){
   // alert('error');
   location.href = location.href;
  }

}, 3000);

function joinGroup () {
	VK.api('groups.isMember', {group_id: 56193663, v: 5, https: 1}, function (res) {
      if(res.response != 1){
        show_box('group');
        group_status = 0;
      }
      if(group_status == 0){
      	setTimeout(function () {
      		joinGroup();
	     }, 300000);
      }
  });
}


VK.Observer.subscribe('widgets.groups.joined', function () {
  group_status = 1;
  ajax.post('reg.php', {uid: <?=(int) $_GET['viewer_id']?>, ukey: '<?=preg_replace('/[^a-zA-ZА-Яа-я0-9\s]/', '', $_GET['auth_key'])?>', act: 'gjoin'}, function (res) {
  	var data = JSON.parse(res);
  	if(data.error == 0){
  	 ge('total_coin').innerHTML = data.money;
	 var audio_html = '<audio autoplay=\"autoplay\"><source src=\"many.mp3\" type=\"audio\/mpeg\"><source src=\"many.ogg\" type=\"audio\/ogg\"><\/audio>';
	 ge('audio_mp3').innerHTML = audio_html;
	 ge('balance').className = 'money_i_red fl_l';
	 setTimeout(function() { ge('balance').className = 'money_i fl_l'; }, 100);
	 box_hide('group');
  	}else if(data.error == 1){
  		// alert('error');
  		location.href = location.href;
  	}else{
  		box_hide('group');
  	}
  });
});


</script>
</html>